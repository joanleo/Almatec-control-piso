<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
	  <head th:replace="fragments/head :: head('Almacen :: Crear Remision')"></head>
	<body>
		<nav th:replace="fragments/navbar :: nav-bar('Almacen')"></nav>
		
		<div class="container my-5" >
			
			<div hidden id="spinner">
				<div>Cargando ...</div>
			</div>
						
						
			<div th:if="${message != null}" class="alert alert-success alert-dismissible fade show" role="alert">
			  <span th:text="${message}"></span>
			  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
			    <span aria-hidden="true">&times;</span>
			  </button>
			</div>
			<div th:if="${error != null}" class="alert alert-danger alert-dismissible fade show" role="alert">
			  <span th:text="${error}"></span>
			  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
			    <span aria-hidden="true">&times;</span>
			  </button>
			 </div>
			 
			 <h2 class="mb-2"> Crear Remision </h2>
			 <form method="post" id="remisionForm">
				 <div class="my-3" style="display: flex; justify-content: space-between;">
			    	<div class="input-group my-3 size-m">
			           <span class="input-group-text">OP </span>
	                   <select class="form-control" id="id-op" required>
						   <option value="" disabled selected hidden>Selecciona numero de OP</option>
	                       <option th:each="num : ${ops}" th:value="${num.IdOpIa}" th:text="${num.NumOp}" th:data-op="${num.cliente + ',' +num.proyecto}"></option>
	                   </select>	
			    	</div>
			    	
			    	<div class="input-group my-3 size-xxl">
			           <span class="input-group-text">Solicitante </span>
			           <input type="text" class="form-control" id="usuario" name="usuario" th:value="${usuario.nombres}" readonly style="text-align: right;" />
					   <input type="hidden" id="usuarioId" name="usuarioId" th:value="${usuario.id}" aria-hidden="true"/>
			    	</div>
					
				</div>
				
				<div style="display: flex; flex-direction: column;" hidden id="solSel">
					<div style="display: flex; justify-content: space-between;">
						<div class="input-group my-3 size-l" >
				           <span class="input-group-text">Cliente</span>
				           <input type="text" class="form-control" id="cliente" readonly style="text-align: right;" />
				    	</div>
						<div class="input-group my-3 size-xxl" >
				           <span class="input-group-text">Proyecto </span>
				           <input type="text" class="form-control" id="proyecto" readonly style="text-align: right;" />
				    	</div>			
					</div>
				</div>
				
				<ul class="nav nav-tabs my-4" hidden id="tabs">
				  <li class="nav-item">
				    <button type="button" id="tab-fabricado" class="nav-link active" aria-current="page" >Fabricado</button>
				  </li>
				  <li class="nav-item">
				    <button type="button" id="tab-ferreteria" class="nav-link">Ferreteria</button>
				  </li>
				</ul>
				
				<div class="table-responsive rounded-3 shadow-sm" style="margin-top: 3rem; margin-bottom: 2rem; max-height: 20rem; overflow-y: auto;">
					<table class="table table-striped table-hover table-rounded caption-top">
						<caption>Items disponibles OP </caption>
						<thead class="table-light sticky-top">
							<tr>
								<th>#</th>
								<th>Item</th>
								<th>Marca</th>
								<th>Descripcion</th>
								<th>Cant Sol</th>
								<th>Cant fabricada</th>
								<th>Cant Entregada</th>
								<th></th>
							</tr>
						</thead>
						<tbody id="body-items-op">									
						</tbody>
					</table>		 				
				</div>	
				
				<div class="table-responsive rounded-3 shadow-sm" style="margin-top: 3rem; margin-bottom: 2rem; max-height: 30rem; overflow-y: auto;">
					<table class="table table-striped table-hover table-rounded caption-top">
						<caption>Detalle Remision </caption>
						<thead class="table-light sticky-top">
							<tr>
								<th>Item</th>
								<th>Marca</th>
								<th>Descripcion</th>
								<th>Cant Sol</th>
								<th>Cant fabricada</th>
								<th>Cant Entregada</th>
								<th></th>
							</tr>
						</thead>
						<tbody id="body-detalle-remision">									
						</tbody>
					</table>		 				
				</div>
				
				<div class="form-floating">
				  <textarea class="form-control" placeholder="Leave a comment here" id="observaciones" style="height: 100px" required></textarea>
				  <label for="observaciones">Observaciones</label>
				</div>
				<div class="d-grid my-4">
					<button type="button" id="submitForm" class="btn btn-primary" onclick="guardarRemision()">Guardar</button>
				</div>  				
			 </form>
			 
			 <div class="modal" id="respuestaModal" tabindex="-1" aria-labelledby="respuestaModalLabel" aria-hidden="true">
	 			  <div class="modal-dialog">
	 			    <div class="modal-content">
	 			      <div class="modal-header">
	 			        <h5 class="modal-title" id="respuestaModalLabel">Creacion de tranferencia</h5>
	 			        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
	 			      </div>
	 			      <div class="modal-body" id="respuestaModalBody">
	 			      </div>
	 			      <div class="modal-footer">
	 			        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
	 			      </div>
	 			    </div>
	 			  </div>
 			 </div>

		</div>
		
		<footer th:replace="fragments/footer :: footer"></footer>
		<script src="/js/bootstrap/bootstrap.bundle.min.js"></script>
		<script src="/js/almacen/formulario-remision.js"></script>
	</body>
</html>